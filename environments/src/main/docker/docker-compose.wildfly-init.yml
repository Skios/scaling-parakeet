services:
  wildfly-init:
    image: quay.io/wildfly/wildfly:${WILDFLY_VERSION:-latest}
    platform: ${PLATFORM:-linux/amd64}
    user: jboss
    entrypoint: [ "/mnt/scripts/init/copy-initial-configs.sh" ]
    volumes:
      - ./wildfly/modules:/mnt/modules
      - ./wildfly/standalone/configuration:/mnt/standalone/configuration
      - ./wildfly/domain/configuration:/mnt/domain/configuration
      - ./wildfly/scripts:/mnt/scripts:ro
    environment:
      - JBOSS_HOME=/opt/jboss/wildfly
      - JBOSS_MODE=${WILDFLY_MODE}
      - JBOSS_DOMAIN_CONFIG=${WILDFLY_DOMAIN_CONFIG}
      - JBOSS_HOST_CONFIG=${WILDFLY_HOST_CONFIG}
      - JBOSS_STANDALONE_CONFIG=${WILDFLY_STANDALONE_CONFIG}
      - WILDFLY_ADMIN_USER=${WILDFLY_ADMIN_USER}
      - WILDFLY_ADMIN_PASSWORD=${WILDFLY_ADMIN_PASSWORD}
    restart: "no"